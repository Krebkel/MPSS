# МПСС
## _Мини-ERP_
Данный веб-сервис позволяет облегчить административную работу, связанную с деятельностью небольшого бизнес-предприятия.

## Возможности
- Авторизация пользователей на основе JWT токенов;
- Управление информацией о сотрудниках и контрагентах;
- Ведение проектов компании;
- Учет работ, услуг и изделий в рамках проектов;
- Учет смен сотрудников и расчет заработной платы;
- Отслеживание расходов по проектам и расчет общей стоимости;

## Технологии

Использован следующий стек:
- Backend - ASP.NET Core, EntityFramework, PostgreSQL;
- Безопасность - JWT (JSON Web Tokens), CORS (Cross-Origin Resource Sharing);
- Frontend - HTML5, CSS3, JavaScript, jQuery, jQuery.Mask;
- Архитектура:
    - Разделенная ответственность между контрактами, доступом к данным и бизнес-логикой;
    - Использование репозиториев и Dependency Injection, API-first подход;
- Дополнительно:
    - Logging и Health Checks для отладки и мониторинга;
    - Docker-ready - возможность быстрого развертывания в контейнерах

## Начало работы

Веб-сервис на данном этапе состоит из четырех страниц. 
- Index - авторизация и регистрация пользователей;
- Projects - инструменты для ведения проектов;
- Employees - инструменты для работы с данными сотрудников;
- Counteragents - инструменты для работы с данными контрагентов.

Для начала работы в данном веб-сервисе необходима регистрация пользователя. При попытке прогрузки любой другой страницы, кроме Index (stc), происходит редирект на авторизацию/регистрацию. После успешной авторизации пользователю выдается JWT токен, с помощью которого у него есть возможность взаимодействать со страницами и эндпоинтами апи.

### Общее

На каждой странице имеется навигационное и боковое меню для удобного и логичного разделения функционала.

В навигационном меню вверху страниц есть три пункта - Проекты, Сотрудники и Контрагенты, характеризующие три главных аспекта деятельности компании. Они ведут на страниицы с соответствующими функциями.

В боковом меню на каждой странице находятся вкладки, в которых собран соответствующий функционал. Одна вкладка - "Главное" - призвана в будущем агрегировать наиболее востребованные функции, и присутствует на каждой из страниц. 

Для каждой таблицы с данными объектов предметной области, будь то проекта или сотрудника, есть возможность добавления новой записи по кнопке "+" сверху таблицы, удаления существующей по кнопке "х" в соответствующей строке, редактирования данных по нажатию на соответствующую строку. При этом удаление при существующих связанных данных на данном этапе не происходит для предотвращения потерь и/или аномалий.

Большая часть данных обновляется автоматически при обновлении данных, однако ещё есть места, где требуется обновление страницы. Все проекты для удобства пользователя отсортированы по дате сдачи по убыванию.

### Проекты
Данная страница собирает в себе функционал, связанный с проектами:
- Вкладка "Проекты":
    - Диаграмма Ганта актуальных проектов. Актуальным считается период [-3;+30] дней относительно текущего (stc).  Есть возможность добавления смен сотрудников по нажатию на ячейку (колонка - день, строка - проект).
    - Список актуальных проектов с возможностью просмотра всех существовавших по кнопке.
- Вкладка "Расходы":
    - Учет расходов сотрудников по каждому проекту. Есть возможность указания оплатившего сотрудника и отметки о компенсации контрагентом.
- Вкладка "Работы":
    - Список доступных компании работ/изделий/услуг для выполнения на проектах. Есть возможность добавления компонентов работ, их количества и веса.
- Вкладка "Итоги":
    - Таблица итоговой стоимости проектов, вычисляемой из количества работ на проекте, расходов и зарплатного фонда.

### Сотрудники
Данная страница собирает в себе функционал, связанный с сотрудниками:
- Вкладка "Зарплаты":
    - Таблицы расчетов заработной платы сотрудников по каждому проекту. Учитываются отработанные смены, индивидуальная стимулирующая надбавка (премия), процент руководителя компании ("шефа"), компенсированные расходы.
- Вкладка "Сотрудники":
    - Список сотрудников с основными их данными. При регистрации пользователя создается сотрудник с ФИО и телефоном, привязывается к пользователю.
- Вкладка "Данные":
    - Список сотрудников с личными данными.

### Контрагенты
Данная страница собирает в себе функционал, связанный с контрагентами:
- Вкладка "Контрагенты":
    - Список компаний, которые могут выступать заказчиками проектов, с контактным лицом и телефоном для связи.
- Вкладка "Данные":
    - Список контрагентов с подробными данными.

Подробнее функционал можно увидеть здесь:
https://youtu.be/qJfgOy57Da4

## Развертывание сервиса
TBA, docker

## TODO
1. Фильтры для списков
2. Расчеты для веса/количества компонентов работ
3. Ручные правки в зарплаты
4. Оптимизация запросов для соблюдения API-first подхода
5. Minor bug fixes
6. ML модель для считывания количества изделий на чертеже проекта.
